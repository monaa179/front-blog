import{_ as E}from"./kYN9ZUdP.js";import{_ as F}from"./BJCqP2a2.js";import{x as q,M as z,g as G,N as O,c as o,p as s,a as e,d as c,t as d,b as A,w as P,r as p,m as R,G as J,q as j,F as h,A as L,v as K,s as f,O as Q,D as v,P as W,o as n,_ as X}from"./C_A17Xze.js";import{f as Y}from"./pMK9VmZY.js";const Z={class:"article-page"},ee={key:0,class:"loading-state"},te={key:1,class:"error-msg"},se={class:"error-info"},oe={key:2,class:"article-container"},ne={class:"main-column"},ie={class:"article-header"},re={class:"title-section"},le={class:"article-title"},ae={class:"article-meta-line"},de={class:"date"},ue={class:"content-section"},ce={class:"section-header"},pe={key:0,class:"version-info"},ve={class:"version-count"},_e={key:0,class:"version-selector"},me=["value"],he={key:1,class:"empty-state"},ge={key:2,class:"content-editor"},ke={class:"editor-toolbar"},we={class:"toolbar-left"},ye={class:"version-tag"},fe={key:0,class:"modified-badge"},be={class:"toolbar-actions"},xe=["disabled"],Ce={class:"editor-body"},Me={class:"side-column"},Ve={class:"sidebar-card"},Be={class:"detail-group"},De={class:"description-text"},Ae={class:"detail-group"},Re=["href"],je={key:1,class:"text-muted"},Le={class:"detail-group"},Ne={class:"modules-list"},Te={key:0,class:"text-muted text-sm"},He=q({__name:"[id]",async setup(Ue){let _,b;const g=z(),N=W(),x=Array.isArray(g.params.id)?g.params.id[0]:g.params.id,{data:i,pending:T,error:C}=([_,b]=G(async()=>Q(`article-${x}`,async()=>await $fetch(`/api/articles/${x}`))),_=await _,b(),_),m=f(0),u=v(()=>i.value?.article_versions?[...i.value.article_versions].sort((r,t)=>new Date(t.created_at).getTime()-new Date(r.created_at).getTime()):[]),M=v(()=>u.value[m.value]||null),k=v(()=>M.value?.content||null),V=v(()=>i.value?.article_modules?i.value.article_modules.map(r=>r.module):[]),a=f(""),w=f(!1),B=v(()=>{const r=k.value||"";return a.value!==r}),H=()=>{a.value=k.value||""};O(k,r=>{a.value=r||""},{immediate:!0});const y=r=>r?Y(new Date(r),"dd/MM/yyyy HH:mm"):"-",U=()=>{a.value&&(navigator.clipboard.writeText(a.value),w.value=!0,setTimeout(()=>{w.value=!1},2e3))},S=()=>{N.back()};return(r,t)=>{const I=E,$=F;return n(),o("div",Z,[s(T)?(n(),o("div",ee,[...t[2]||(t[2]=[e("div",{class:"spinner"},null,-1),c(" Chargement de l'article... ",-1)])])):s(C)?(n(),o("div",te,[e("div",se,[t[3]||(t[3]=e("h3",null,"Erreur lors du chargement",-1)),e("p",null,d(s(C).message||"Une erreur est survenue lors de la récupération des données."),1)]),A(I,{to:"/dashboard",class:"btn btn-secondary"},{default:P(()=>[...t[4]||(t[4]=[c("Retour au dashboard",-1)])]),_:1})])):s(i)?(n(),o("div",oe,[e("div",ne,[e("header",ie,[e("a",{onClick:S,class:"back-link"},[...t[5]||(t[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),c(" Retour ",-1)])]),e("div",re,[e("h1",le,d(s(i).original_title),1),e("div",ae,[A($,{status:s(i).status},null,8,["status"]),t[6]||(t[6]=e("span",{class:"dot"},"•",-1)),e("span",de,"Mis à jour le "+d(y(s(i).updated_at)),1)])])]),e("section",ue,[e("div",ce,[t[7]||(t[7]=e("h3",null,"Contenu Rédigé",-1)),s(u).length>0?(n(),o("div",pe,[e("span",ve,d(s(u).length)+" version(s) disponible(s)",1)])):p("",!0)]),s(u).length>1?(n(),o("div",_e,[t[8]||(t[8]=e("label",{for:"version-select"},"Choisir une version :",-1)),R(e("select",{id:"version-select","onUpdate:modelValue":t[0]||(t[0]=l=>j(m)?m.value=l:null)},[(n(!0),o(h,null,L(s(u),(l,D)=>(n(),o("option",{key:l.id,value:D}," Version "+d(l.version_number||s(u).length-D)+" ("+d(y(l.created_at))+") ",9,me))),128))],512),[[J,s(m)]])])):p("",!0),s(u).length===0?(n(),o("div",he,[...t[9]||(t[9]=[e("div",{class:"empty-icon"},"✍️",-1),e("h4",null,"Aucun contenu rédigé pour cet article",-1),e("p",null,"Le contenu apparaîtra ici une fois la génération terminée.",-1)])])):(n(),o("div",ge,[e("div",ke,[e("div",we,[e("span",ye,[t[10]||(t[10]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("polyline",{points:"12 6 12 12 16 14"})],-1)),c(" Version du "+d(y(s(M)?.created_at)),1)]),s(B)?(n(),o("span",fe,"Modifié")):p("",!0)]),e("div",be,[s(B)?(n(),o("button",{key:0,class:"btn btn-ghost btn-sm reset-btn",onClick:H}," Réinitialiser ")):p("",!0),e("button",{class:"btn btn-primary btn-sm copy-btn",onClick:U,disabled:!s(a)},[s(w)?(n(),o(h,{key:0},[t[11]||(t[11]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"20 6 9 17 4 12"})],-1)),t[12]||(t[12]=c(" Copié ✓ ",-1))],64)):(n(),o(h,{key:1},[t[13]||(t[13]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),e("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})],-1)),t[14]||(t[14]=c(" Copier le contenu ",-1))],64))],8,xe)])]),e("div",Ce,[R(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=l=>j(a)?a.value=l:null),class:"markdown-editor",placeholder:"Le contenu de cette version est vide. Commencez à rédiger ici..."},null,512),[[K,s(a)]])])]))])]),e("aside",Me,[e("div",Ve,[t[19]||(t[19]=e("h3",{class:"sidebar-heading"},"Détails de l'article",-1)),e("div",Be,[t[15]||(t[15]=e("label",null,"Description originale",-1)),e("p",De,d(s(i).original_description||"Aucune description fournie."),1)]),e("div",Ae,[t[17]||(t[17]=e("label",null,"URL Source",-1)),s(i).source_url?(n(),o("a",{key:0,href:s(i).source_url,target:"_blank",class:"link-item"},[...t[16]||(t[16]=[c(" Voir la source ",-1),e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),e("polyline",{points:"15 3 21 3 21 9"}),e("line",{x1:"10",y1:"14",x2:"21",y2:"3"})],-1)])],8,Re)):(n(),o("span",je,"Aucune URL source"))]),e("div",Le,[t[18]||(t[18]=e("label",null,"Modules activés",-1)),e("div",Ne,[(n(!0),o(h,null,L(s(V),l=>(n(),o("span",{key:l.id,class:"module-tag"},d(l.name),1))),128)),s(V).length===0?(n(),o("span",Te,"Aucun module")):p("",!0)])])])])])):p("",!0)])}}}),Fe=X(He,[["__scopeId","data-v-20345846"]]);export{Fe as default};
