import{s as l}from"./C_A17Xze.js";const m=(s={})=>{const a=l([]),o=l(!1),u=l(null),i=l([]);return{articles:a,loading:o,error:u,allModules:i,fetch:async()=>{o.value=!0,u.value=null;try{const e={};s.statuses&&s.statuses.length>0&&(e.statuses=s.statuses),s.order&&(e.orderCol=s.order.column,e.ascending=String(s.order.ascending));const t=await $fetch("/api/articles",{query:e});a.value=t}catch(e){console.error("[useArticles] fetch error",e),u.value=e?.data?.statusMessage||e?.message||"Failed to fetch articles"}finally{o.value=!1}},fetchArticleStats:async()=>{const e={proposed:0,validated:0,published:0,abandoned:0,written:0};try{(await $fetch("/api/articles")).forEach(r=>{const c=r.status?.toLowerCase();c in e&&e[c]++})}catch(t){console.error("[useArticles] fetchArticleStats error",t)}return e},deleteArticle:async e=>{try{return await $fetch(`/api/articles/${e}`,{method:"DELETE"}),a.value=a.value.filter(t=>t.id!==e),!0}catch(t){return console.error("[useArticles] delete error",t),!1}},updateStatus:async(e,t)=>{try{await $fetch(`/api/articles/${e}`,{method:"PATCH",body:{status:t}});const r=a.value.find(c=>c.id===e);return r&&(r.status=t),!0}catch(r){return console.error("[useArticles] updateStatus error",r),!1}},fetchModules:async()=>{try{const e=await $fetch("/api/modules",{query:{active:"true"}});i.value=e||[]}catch(e){console.error("[useArticles] fetchModules error",e)}},updateModules:async(e,t)=>{try{await $fetch(`/api/articles/${e}`,{method:"PATCH",body:{modules:t}});const r=a.value.find(c=>c.id===e);return r&&(r.modules=t),!0}catch(r){return console.error("[useArticles] updateModules error",r),!1}},archiveArticle:async e=>{try{return await $fetch(`/api/articles/${e}`,{method:"PATCH",body:{status:"abandoned"}}),a.value=a.value.filter(t=>t.id!==e),!0}catch(t){return console.error("[useArticles] archive error",t),!1}}}};export{m as u};
