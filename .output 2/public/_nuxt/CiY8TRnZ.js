import{x as L,k as q,y as U,c as u,a as e,m as c,v as g,p as s,H as V,r as w,t as p,I as A,z as j,F as z,A as H,b as T,l as O,s as i,o as r,C as F,d as P,_ as G}from"./C_A17Xze.js";import{L as R}from"./CG3JdVlk.js";import{C as J}from"./Ckzw1s2j.js";const K={class:"modules-page"},Q={class:"create-section glass-panel"},W={class:"form-grid"},X={class:"form-group"},Y={class:"form-group text-center"},Z={class:"form-group checkbox-cell"},ee={class:"checkbox-container"},te={class:"form-actions"},le=["disabled"],se={key:0,class:"loader-sm"},oe={class:"form-group full-width mt-20"},ae={class:"list-section"},ne={key:1,class:"table-container glass-panel"},ie={class:"modern-table"},re={key:0},de={class:"module-name"},ue=["title"],ce={class:"slug-badge"},pe=["onClick"],ve={class:"text-right"},me={class:"actions-group"},fe=["onClick"],ge=["onClick"],be={class:"modal-content glass-panel edit-modal"},he={class:"modal-body"},ke={class:"form-group"},we={class:"form-group mt-20"},ye={class:"form-group mt-20"},xe={class:"checkbox-container"},Ce={class:"modal-footer"},Me=["disabled"],_e={key:0,class:"loader-sm"},Ve=L({__name:"modules",setup(Ae){q();const d=i([]),y=i(!0),v=i(!1),m=i(!1),a=i({name:"",slug:"",description:"",active:!0}),E=()=>{a.value.slug=a.value.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w\s-]/g,"").replace(/\s+/g,"-")},M=async()=>{y.value=!0;try{const o=await $fetch("/api/modules");d.value=o||[]}catch(o){console.error("Error fetching modules:",o)}finally{y.value=!1}},D=async()=>{if(a.value.name){v.value=!0;try{await $fetch("/api/modules",{method:"POST",body:{name:a.value.name,slug:a.value.slug,description:a.value.description,active:a.value.active}}),a.value={name:"",slug:"",description:"",active:!0},M()}catch(o){console.error("Error creating module:",o)}finally{v.value=!1}}},S=async o=>{const t=!o.active,l=o.active;o.active=t;try{await $fetch(`/api/modules/${o.id}`,{method:"PATCH",body:{active:t}})}catch(k){o.active=l,console.error("Error updating module:",k)}},x=i(!1),f=i(null),b=i(!1),$=o=>{f.value=o,x.value=!0},_=()=>{x.value=!1,f.value=null,b.value=!1},I=async()=>{if(f.value){b.value=!0;try{await $fetch(`/api/modules/${f.value}`,{method:"DELETE"}),d.value=d.value.filter(o=>o.id!==f.value),_()}catch(o){console.error("Error deleting module:",o)}finally{b.value=!1}}},C=i(!1),n=i({}),N=o=>{n.value={...o},C.value=!0},h=()=>{C.value=!1,n.value={}},B=async()=>{if(!(!n.value.id||!n.value.name)){m.value=!0;try{const o=await $fetch(`/api/modules/${n.value.id}`,{method:"PATCH",body:{name:n.value.name,description:n.value.description,active:n.value.active}}),t=d.value.findIndex(l=>l.id===n.value.id);t!==-1&&(d.value[t]={...d.value[t],...o}),h()}catch(o){console.error("Error updating module:",o)}finally{m.value=!1}}};return U(()=>{M()}),(o,t)=>(r(),u("div",K,[t[26]||(t[26]=e("header",{class:"page-header"},[e("div",{class:"header-text"},[e("h1",null,"Modules"),e("p",{class:"subtitle"},"Gérez les modules d'analyse et de rédaction.")])],-1)),e("div",Q,[t[13]||(t[13]=e("div",{class:"section-title"},"Nouveau Module",-1)),e("div",W,[e("div",X,[t[7]||(t[7]=e("label",null,"Nom du module",-1)),c(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s(a).name=l),type:"text",placeholder:"Ex: Analyse SEO",onInput:E},null,544),[[g,s(a).name]])]),e("div",Y,[t[8]||(t[8]=e("label",null,"Slug (Auto)",-1)),c(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>s(a).slug=l),type:"text",disabled:"",class:"slug-input"},null,512),[[g,s(a).slug]])]),e("div",Z,[e("label",ee,[c(e("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=l=>s(a).active=l)},null,512),[[V,s(a).active]]),t[9]||(t[9]=e("span",{class:"checkmark"},null,-1)),t[10]||(t[10]=e("span",{class:"label-text"},"Actif par défaut",-1))])]),e("div",te,[e("button",{class:"btn btn-primary btn-full",onClick:D,disabled:!s(a).name||s(v)},[s(v)?(r(),u("div",se)):w("",!0),e("span",null,p(s(v)?"Ajout...":"Ajouter"),1)],8,le)])]),e("div",oe,[t[11]||(t[11]=A('<label class="ai-label" data-v-3f3fb53c><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ai-icon" data-v-3f3fb53c><path d="M12 2a10 10 0 1 0 10 10H12V2z" data-v-3f3fb53c></path><path d="M12 12L2.69 7" data-v-3f3fb53c></path><path d="M12 12l5.63 8.35" data-v-3f3fb53c></path></svg> Description (Instructions IA) </label>',1)),c(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=l=>s(a).description=l),placeholder:"Décris ce que l'article doit aborder lorsque ce module est sélectionné...",rows:"3"},null,512),[[g,s(a).description]]),t[12]||(t[12]=e("p",{class:"help-text"},"Décris ce que l’article doit aborder lorsque ce module est sélectionné.",-1))])]),e("div",ae,[s(y)?(r(),j(R,{key:0,message:"Chargement des modules..."})):(r(),u("div",ne,[e("table",ie,[t[18]||(t[18]=e("thead",null,[e("tr",null,[e("th",null,"Nom"),e("th",null,"Description"),e("th",null,"Slug"),e("th",null,"Statut"),e("th",{style:{"text-align":"right"}},"Actions")])],-1)),e("tbody",null,[s(d).length===0?(r(),u("tr",re,[...t[14]||(t[14]=[e("td",{colspan:"5",class:"empty-row"},"Aucun module trouvé.",-1)])])):w("",!0),(r(!0),u(z,null,H(s(d),l=>(r(),u("tr",{key:l.id,class:"module-row"},[e("td",null,[e("span",de,p(l.name),1)]),e("td",null,[e("span",{class:"module-description",title:l.description},p(l.description||"Aucune description"),9,ue)]),e("td",null,[e("code",ce,p(l.slug),1)]),e("td",null,[e("button",{class:F(["status-pill",{active:l.active}]),onClick:k=>S(l)},[t[15]||(t[15]=e("span",{class:"status-dot"},null,-1)),P(" "+p(l.active?"Actif":"Inactif"),1)],10,pe)]),e("td",ve,[e("div",me,[e("button",{class:"btn btn-ghost btn-sm btn-square",onClick:k=>N(l),title:"Modifier"},[...t[16]||(t[16]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,fe),e("button",{class:"btn btn-ghost btn-sm btn-square text-danger",onClick:k=>$(l.id),title:"Supprimer"},[...t[17]||(t[17]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,ge)])])]))),128))])])]))]),T(J,{"is-open":s(x),title:"Supprimer le module",description:"Êtes-vous sûr de vouloir supprimer ce module ? Cette action est irréversible.","confirm-label":"Supprimer",type:"danger",loading:s(b),onCancel:_,onConfirm:I},null,8,["is-open","loading"]),s(C)?(r(),u("div",{key:0,class:"modal-overlay",onClick:O(h,["self"])},[e("div",be,[e("header",{class:"modal-header"},[t[20]||(t[20]=e("h3",null,"Modifier le Module",-1)),e("button",{class:"close-btn",onClick:h},[...t[19]||(t[19]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),e("div",he,[e("div",ke,[t[21]||(t[21]=e("label",null,"Nom du module",-1)),c(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>s(n).name=l),type:"text"},null,512),[[g,s(n).name]])]),e("div",we,[t[22]||(t[22]=A('<label class="ai-label" data-v-3f3fb53c><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ai-icon" data-v-3f3fb53c><path d="M12 2a10 10 0 1 0 10 10H12V2z" data-v-3f3fb53c></path><path d="M12 12L2.69 7" data-v-3f3fb53c></path><path d="M12 12l5.63 8.35" data-v-3f3fb53c></path></svg> Description (Instructions IA) </label>',1)),c(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=l=>s(n).description=l),rows:"5"},null,512),[[g,s(n).description]]),t[23]||(t[23]=e("p",{class:"help-text"},"Décris ce que l’article doit aborder lorsque ce module est sélectionné.",-1))]),e("div",ye,[e("label",xe,[c(e("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=l=>s(n).active=l)},null,512),[[V,s(n).active]]),t[24]||(t[24]=e("span",{class:"checkmark"},null,-1)),t[25]||(t[25]=e("span",{class:"label-text"},"Module actif",-1))])])]),e("footer",Ce,[e("button",{class:"btn btn-ghost",onClick:h},"Annuler"),e("button",{class:"btn btn-primary",onClick:B,disabled:s(m)},[s(m)?(r(),u("div",_e)):w("",!0),e("span",null,p(s(m)?"Enregistrement...":"Enregistrer"),1)],8,Me)])])])):w("",!0)]))}}),$e=G(Ve,[["__scopeId","data-v-3f3fb53c"]]);export{$e as default};
